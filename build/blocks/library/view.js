import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(o={getConfig:()=>e.getConfig,getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store},i={},t.d(i,o),i),a={bouncer:{disableSubmit:!0,customValidations:{valueMismatch(e){const t=e.getAttribute("data-bouncer-match");if(!t)return!1;const n=e.form.querySelector("[name="+t+"]");return!!n&&n.value!==e.value}},messageCustom:"data-bouncer-message",messages:{valueMismatch:e=>e.getAttribute("data-bouncer-mismatch-message")||"Please make sure the fields match."}},tinyMce:{selector:"textarea.formello-advanced",setup:e=>{e.on("change",(()=>{window.tinymce.triggerSave()}))},menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"formatselect | bold italic underline | bullist numlist  | alignleft aligncenter alignright alignjustify | link unlink | undo redo",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"}},{state:s}=(0,n.store)("formello",{state:{get message(){const e=(0,n.getContext)();return e.response?.data?.errors?e.response?.data?.message:e.response&&e.successMessage.length?e.successMessage:e.response?.data?.message},get errors(){const e=(0,n.getContext)();return e.response?.data?.errors||[]}},actions:{validateCaptcha:e=>{const{ref:t}=(0,n.getElement)();if(e.preventDefault(),!t.closest("form").checkValidity())return t.closest("form").requestSubmit(t),!1;(0,n.getContext)().isLoading=!0,(async()=>{const e=(0,n.getConfig)(),t=(0,n.getContext)();if(t.captchaEnabled&&"reCaptcha"===t.captchaType&&"invisible"===e.settings.reCaptcha.version)return window.grecaptcha.execute();t.captchaEnabled&&"hCaptcha"===t.captchaType&&await window.hcaptcha.execute({async:!0})})().then((()=>{t.closest("form").requestSubmit(t)}))},sendForm:e=>{e.preventDefault(),e.stopPropagation();const{ref:t}=(0,n.getElement)(),a=(0,n.getContext)();if(a.enableJsValidation&&!t.checkValidity()){const e=t.querySelector("input:invalid, select:invalid");return e?.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),void e?.focus()}a.isLoading=!0,(async()=>{const{ref:e}=(0,n.getElement)(),t=(0,n.getContext)(),a=(0,n.getConfig)(),{id:o}=e.dataset,i=new FormData(e);i.append("action","formello"),i.append("_formello",a.nonce),i.append("_formello_id",o);try{t.isLoading=!0,t.response=!1;const n=await fetch(a.ajax_url,{method:"POST",body:i}),o=await n.json();t.response=o,t.isLoading=!1,((e,t,n)=>{const{data:a}=t;if(a.redirect_url&&t.success)return window.location=a.redirect_url,!1;const s=e.querySelector(".wp-block-formello-message");t.success&&!s.firstElementChild.textContent&&(s.firstElementChild.innerHTML=a.message),a.hide&&t.success&&(e.insertAdjacentElement("beforebegin",s),setTimeout((()=>{e.style.display="none",s.scrollIntoView({behavior:"smooth"})}),"300")),a.debug&&(console.info(a.debug),n.debugData=JSON.stringify(t.data.debug,void 0,2)),t.success&&e.reset()})(e,o,s)}catch(e){t.isLoading=!1,t.response="string"==typeof e||e instanceof String?{data:{message:e},success:!1}:{data:{message:"An error occurred"},success:!1}}})()},setOutput:()=>{const{ref:e}=(0,n.getElement)();"OUTPUT"===e.nextElementSibling?.nodeName&&(e.nextElementSibling.value=e.value)},validateInput:()=>{(0,n.getContext)().enableJsValidation&&(()=>{const{ref:e}=(0,n.getElement)(),t=(0,n.getContext)(),{settings:a}=(0,n.getConfig)();if(t.error="","tel"===e.type&&e.classList.contains("formello-advanced")&&!window.intlTelInput.getInstance(e).isValidNumber()&&e.value)window.intlTelInput.getInstance(e).getValidationError(),e.setCustomValidity("Please match the number format."),t.error=e.validationMessage;else if("tel"===e.type&&e.classList.contains("formello-advanced")){const t=window.intlTelInput?.getInstance(e).getNumber();document.querySelector('input[name="'+e.name+'_full"]').setAttribute("value",t),e.setCustomValidity("")}else e.setCustomValidity("");if("checkbox"===e.type&&e.getAttribute("name").includes("[]")){const t=e.closest(".wp-block-formello-multichoices").querySelector("input[type=checkbox]:checked"),n=e.closest(".wp-block-formello-multichoices").querySelectorAll("input[type=checkbox]:not(:checked)");t?n.forEach((e=>{e.required=!1})):e.closest(".wp-block-formello-multichoices").querySelectorAll("input[type=checkbox]").forEach((e=>{e.required=!0}))}var s,o;e.validity.rangeOverflow&&"time"===e.type&&(t.error=a.messages.outOfRange.over.replace("{max}",e.getAttribute("max").replace("{max}",e.value.max))),e.validity.rangeUnderflow&&"time"===e.type&&(t.error=a.messages.outOfRange.under.replace("{min}",e.getAttribute("min").replace("{min}",e.value.min))),e.validity.tooShort&&(t.error=a.messages.wrongLength.under.replace("{minLength}",e.getAttribute("minlength").replace("{length}",e.value.length))),e.validity.tooLong&&(t.error=a.messages.wrongLength.over.replace("{maxLength}",e.getAttribute("maxlength").replace("{length}",e.value.length))),(e.validity.typeMismatch||e.validity.badInput)&&(t.error=a.messages.patternMismatch[e.type]),e.validity.patternMismatch&&(t.error=null!==(s=null!==(o=a.messages.patternMismatch[e.type])&&void 0!==o?o:e.getAttribute("data-bouncer-message"))&&void 0!==s?s:a.messages.patternMismatch.default),e.validity.valueMissing&&(t.error=a.messages.missingValue.hasOwnProperty(e.type)?a.messages.missingValue[e.type]:a.messages.missingValue.default)})()}},callbacks:{showDebug:()=>{const{ref:e}=(0,n.getElement)();s.debugData&&(window.renderjson.set_show_to_level(2),e.innerHTML="",e.appendChild(window.renderjson(JSON.parse(s.debugData))))},init:()=>{const e=(0,n.getContext)(),t=(0,n.getConfig)();e.messages={...a.bouncer.messages,...t.settings.messages},window.tinymce?.init(a.tinyMce),document.querySelectorAll("input.formello-advanced[type=text]").forEach((e=>{const{flatpickr:t}=e.dataset;window.flatpickr?.(e,JSON.parse(t))})),document.querySelectorAll('input[type="tel"].formello-advanced').forEach((e=>{window.intlTelInput?.(e,{loadUtilsOnInit:"https://cdn.jsdelivr.net/npm/intl-tel-input@24.6.0/build/js/utils.js",hiddenInput:e=>({phone:e+"_full",country:e+"_country_code"}),initialCountry:"auto",geoIpLookup:e=>{fetch("https://ipapi.co/json").then((e=>e.json())).then((t=>e(t.country_code))).catch((()=>e("us")))}})})),document.querySelectorAll("select.formello-advanced").forEach((e=>{new window.TomSelect(e,{create:!0,sortField:{field:"text",direction:"asc"}})}))}}});var o,i;